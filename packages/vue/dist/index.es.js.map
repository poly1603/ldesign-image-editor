{"version":3,"file":"index.es.js","sources":["../src/composables/useImageEditor.ts","../src/composables/useEditorEvents.ts","../src/components/ImageEditor/ImageEditor.vue","../src/index.ts"],"sourcesContent":["/**\r\n * useImageEditor composable - Manages Editor instance lifecycle\r\n * Requirements: 9.1, 9.4\r\n * \r\n * @example\r\n * ```vue\r\n * <script setup>\r\n * import { useImageEditor } from '@ldesign/image-editor-vue';\r\n * import { MosaicPlugin } from '@ldesign/image-editor';\r\n * \r\n * const containerRef = ref<HTMLElement>();\r\n * const { editor, isReady, loadImage, undo, redo } = useImageEditor({\r\n *   plugins: [MosaicPlugin],\r\n * });\r\n * \r\n * onMounted(() => {\r\n *   if (containerRef.value) {\r\n *     init(containerRef.value);\r\n *   }\r\n * });\r\n * </script>\r\n * ```\r\n */\r\n\r\nimport { ref, shallowRef, onUnmounted, type Ref } from 'vue';\r\nimport { Editor, type EditorOptions, type ExportOptions } from '@ldesign/image-editor';\r\nimport type { UseImageEditorOptions } from '../types';\r\n\r\n/**\r\n * Composable for managing image editor instance\r\n * Requirements: 9.1, 9.4\r\n * \r\n * @param options - Editor options\r\n * @returns Editor state and methods\r\n */\r\nexport function useImageEditor(options: UseImageEditorOptions = {}): {\r\n  editor: Ref<Editor | null>;\r\n  isReady: Ref<boolean>;\r\n  isLoading: Ref<boolean>;\r\n  error: Ref<Error | null>;\r\n  currentTool: Ref<string | null>;\r\n  canUndo: Ref<boolean>;\r\n  canRedo: Ref<boolean>;\r\n  width: Ref<number>;\r\n  height: Ref<number>;\r\n  init: (container: HTMLElement) => void;\r\n  loadImage: (source: string) => Promise<void>;\r\n  exportImage: (exportOptions?: ExportOptions) => Promise<string | Blob | File>;\r\n  undo: () => void;\r\n  redo: () => void;\r\n  setTool: (tool: string) => void;\r\n  destroy: () => void;\r\n} {\r\n  // Reactive state\r\n  const editor = shallowRef<Editor | null>(null);\r\n  const isReady = ref(false);\r\n  const isLoading = ref(false);\r\n  const error = ref<Error | null>(null);\r\n  const currentTool = ref<string | null>(null);\r\n  const canUndo = ref(false);\r\n  const canRedo = ref(false);\r\n  const width = ref(0);\r\n  const height = ref(0);\r\n\r\n  /**\r\n   * Initialize the editor with a container element\r\n   * @param container - Container element\r\n   */\r\n  function init(container: HTMLElement): void {\r\n    // Destroy existing editor if any\r\n    if (editor.value) {\r\n      destroy();\r\n    }\r\n\r\n    try {\r\n      // Build editor options - spread all options including toolbar config\r\n      const editorOptions: EditorOptions = {\r\n        container,\r\n        width: options.width,\r\n        height: options.height,\r\n        plugins: options.plugins,\r\n        image: options.image,\r\n        ...options.options,\r\n      };\r\n\r\n      // Create editor instance\r\n      const editorInstance = new Editor(editorOptions);\r\n      editor.value = editorInstance;\r\n\r\n      // Setup event listeners for reactive state\r\n      setupEventListeners(editorInstance);\r\n\r\n      // Update initial dimensions\r\n      width.value = editorInstance.width;\r\n      height.value = editorInstance.height;\r\n    } catch (err) {\r\n      error.value = err instanceof Error ? err : new Error(String(err));\r\n      throw err;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Setup event listeners for reactive state updates\r\n   * @param editorInstance - Editor instance\r\n   */\r\n  function setupEventListeners(editorInstance: Editor): void {\r\n    editorInstance.on('ready', (data) => {\r\n      isReady.value = true;\r\n      isLoading.value = false;\r\n      width.value = data.width;\r\n      height.value = data.height;\r\n    });\r\n\r\n    editorInstance.on('error', (data) => {\r\n      error.value = data.error;\r\n      isLoading.value = false;\r\n    });\r\n\r\n    editorInstance.on('tool-change', (data) => {\r\n      currentTool.value = data.tool || null;\r\n    });\r\n\r\n    editorInstance.on('history-change', (data) => {\r\n      canUndo.value = data.canUndo;\r\n      canRedo.value = data.canRedo;\r\n    });\r\n\r\n    editorInstance.on('image-loaded', (data) => {\r\n      width.value = data.width;\r\n      height.value = data.height;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Load an image into the editor\r\n   * @param source - Image source URL\r\n   */\r\n  async function loadImage(source: string): Promise<void> {\r\n    if (!editor.value) {\r\n      throw new Error('Editor not initialized');\r\n    }\r\n\r\n    isLoading.value = true;\r\n    error.value = null;\r\n\r\n    try {\r\n      await editor.value.loadImage(source);\r\n    } catch (err) {\r\n      error.value = err instanceof Error ? err : new Error(String(err));\r\n      throw err;\r\n    } finally {\r\n      isLoading.value = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Export the edited image\r\n   * @param exportOptions - Export options\r\n   * @returns Exported image data\r\n   */\r\n  async function exportImage(exportOptions?: ExportOptions): Promise<string | Blob | File> {\r\n    if (!editor.value) {\r\n      throw new Error('Editor not initialized');\r\n    }\r\n\r\n    return editor.value.export(exportOptions);\r\n  }\r\n\r\n  /**\r\n   * Undo the last operation\r\n   */\r\n  function undo(): void {\r\n    if (editor.value) {\r\n      editor.value.undo();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Redo the last undone operation\r\n   */\r\n  function redo(): void {\r\n    if (editor.value) {\r\n      editor.value.redo();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set the current tool\r\n   * @param tool - Tool name\r\n   */\r\n  function setTool(tool: string): void {\r\n    if (editor.value) {\r\n      editor.value.setTool(tool);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Destroy the editor and clean up resources\r\n   */\r\n  function destroy(): void {\r\n    if (editor.value) {\r\n      editor.value.destroy();\r\n      editor.value = null;\r\n      isReady.value = false;\r\n      isLoading.value = false;\r\n      error.value = null;\r\n      currentTool.value = null;\r\n      canUndo.value = false;\r\n      canRedo.value = false;\r\n      width.value = 0;\r\n      height.value = 0;\r\n    }\r\n  }\r\n\r\n  // Auto cleanup on unmount\r\n  onUnmounted(() => {\r\n    destroy();\r\n  });\r\n\r\n  return {\r\n    editor,\r\n    isReady,\r\n    isLoading,\r\n    error,\r\n    currentTool,\r\n    canUndo,\r\n    canRedo,\r\n    width,\r\n    height,\r\n    init,\r\n    loadImage,\r\n    exportImage,\r\n    undo,\r\n    redo,\r\n    setTool,\r\n    destroy,\r\n  };\r\n}\r\n","/**\r\n * useEditorEvents composable - Manages editor event subscriptions\r\n * Requirements: 9.3\r\n * \r\n * @example\r\n * ```vue\r\n * <script setup>\r\n * import { useEditorEvents } from '@image-editor/vue';\r\n * \r\n * const { onReady, onError, onToolChange } = useEditorEvents(editor);\r\n * \r\n * onReady(({ width, height }) => {\r\n *   console.log(`Editor ready: ${width}x${height}`);\r\n * });\r\n * \r\n * onError(({ error }) => {\r\n *   console.error('Editor error:', error);\r\n * });\r\n * </script>\r\n * ```\r\n */\r\n\r\nimport { watch, onUnmounted, type Ref } from 'vue';\r\nimport type { Editor, EditorEvents, EventHandler } from '@ldesign/image-editor';\r\n\r\n/**\r\n * Event cleanup function type\r\n */\r\ntype CleanupFn = () => void;\r\n\r\n/**\r\n * Event handler registration function type\r\n */\r\ntype EventRegistration<T> = (handler: EventHandler<T>) => CleanupFn;\r\n\r\n/**\r\n * useEditorEvents return type\r\n */\r\nexport interface UseEditorEventsReturn {\r\n  /** Subscribe to ready event */\r\n  onReady: EventRegistration<EditorEvents['ready']>;\r\n  /** Subscribe to error event */\r\n  onError: EventRegistration<EditorEvents['error']>;\r\n  /** Subscribe to image-loaded event */\r\n  onImageLoaded: EventRegistration<EditorEvents['image-loaded']>;\r\n  /** Subscribe to tool-change event */\r\n  onToolChange: EventRegistration<EditorEvents['tool-change']>;\r\n  /** Subscribe to history-change event */\r\n  onHistoryChange: EventRegistration<EditorEvents['history-change']>;\r\n  /** Subscribe to before-export event */\r\n  onBeforeExport: EventRegistration<EditorEvents['before-export']>;\r\n  /** Subscribe to after-export event */\r\n  onAfterExport: EventRegistration<EditorEvents['after-export']>;\r\n  /** Subscribe to destroy event */\r\n  onDestroy: EventRegistration<void>;\r\n  /** Subscribe to any event */\r\n  on: <K extends keyof EditorEvents>(event: K, handler: EventHandler<EditorEvents[K]>) => CleanupFn;\r\n  /** Unsubscribe from any event */\r\n  off: <K extends keyof EditorEvents>(event: K, handler: EventHandler<EditorEvents[K]>) => void;\r\n  /** Remove all event listeners */\r\n  removeAllListeners: () => void;\r\n}\r\n\r\n/**\r\n * Composable for managing editor event subscriptions with automatic cleanup\r\n * Requirements: 9.3\r\n * \r\n * @param editorRef - Ref to Editor instance\r\n * @returns Event subscription methods\r\n */\r\nexport function useEditorEvents(editorRef: Ref<Editor | null>): UseEditorEventsReturn {\r\n  // Track all registered handlers for cleanup\r\n  const registeredHandlers: Array<{\r\n    event: keyof EditorEvents;\r\n    handler: EventHandler<unknown>;\r\n  }> = [];\r\n\r\n  /**\r\n   * Create an event registration function for a specific event\r\n   * @param event - Event name\r\n   * @returns Event registration function\r\n   */\r\n  function createEventRegistration<K extends keyof EditorEvents>(\r\n    event: K\r\n  ): EventRegistration<EditorEvents[K]> {\r\n    return (handler: EventHandler<EditorEvents[K]>): CleanupFn => {\r\n      return on(event, handler);\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Subscribe to an editor event\r\n   * @param event - Event name\r\n   * @param handler - Event handler\r\n   * @returns Cleanup function\r\n   */\r\n  function on<K extends keyof EditorEvents>(\r\n    event: K,\r\n    handler: EventHandler<EditorEvents[K]>\r\n  ): CleanupFn {\r\n    // Register handler if editor exists\r\n    if (editorRef.value) {\r\n      editorRef.value.on(event, handler);\r\n    }\r\n\r\n    // Track handler for cleanup and re-registration\r\n    registeredHandlers.push({\r\n      event,\r\n      handler: handler as EventHandler<unknown>,\r\n    });\r\n\r\n    // Watch for editor changes to re-register handlers\r\n    const stopWatch = watch(\r\n      () => editorRef.value,\r\n      (newEditor, oldEditor) => {\r\n        // Unregister from old editor\r\n        if (oldEditor) {\r\n          oldEditor.off(event, handler);\r\n        }\r\n        // Register to new editor\r\n        if (newEditor) {\r\n          newEditor.on(event, handler);\r\n        }\r\n      }\r\n    );\r\n\r\n    // Return cleanup function\r\n    return () => {\r\n      stopWatch();\r\n      if (editorRef.value) {\r\n        editorRef.value.off(event, handler);\r\n      }\r\n      // Remove from tracked handlers\r\n      const index = registeredHandlers.findIndex(\r\n        (h) => h.event === event && h.handler === handler\r\n      );\r\n      if (index !== -1) {\r\n        registeredHandlers.splice(index, 1);\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Unsubscribe from an editor event\r\n   * @param event - Event name\r\n   * @param handler - Event handler\r\n   */\r\n  function off<K extends keyof EditorEvents>(\r\n    event: K,\r\n    handler: EventHandler<EditorEvents[K]>\r\n  ): void {\r\n    if (editorRef.value) {\r\n      editorRef.value.off(event, handler);\r\n    }\r\n    // Remove from tracked handlers\r\n    const index = registeredHandlers.findIndex(\r\n      (h) => h.event === event && h.handler === handler\r\n    );\r\n    if (index !== -1) {\r\n      registeredHandlers.splice(index, 1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove all registered event listeners\r\n   */\r\n  function removeAllListeners(): void {\r\n    if (editorRef.value) {\r\n      for (const { event, handler } of registeredHandlers) {\r\n        editorRef.value.off(event, handler as EventHandler<EditorEvents[typeof event]>);\r\n      }\r\n    }\r\n    registeredHandlers.length = 0;\r\n  }\r\n\r\n  // Auto cleanup on unmount\r\n  onUnmounted(() => {\r\n    removeAllListeners();\r\n  });\r\n\r\n  return {\r\n    onReady: createEventRegistration('ready'),\r\n    onError: createEventRegistration('error'),\r\n    onImageLoaded: createEventRegistration('image-loaded'),\r\n    onToolChange: createEventRegistration('tool-change'),\r\n    onHistoryChange: createEventRegistration('history-change'),\r\n    onBeforeExport: createEventRegistration('before-export'),\r\n    onAfterExport: createEventRegistration('after-export'),\r\n    onDestroy: createEventRegistration('destroy') as EventRegistration<void>,\r\n    on,\r\n    off,\r\n    removeAllListeners,\r\n  };\r\n}\r\n","<script setup lang=\"ts\">\r\n/**\r\n * ImageEditor Vue Component\r\n * Requirements: 9.1, 9.2, 9.3, 9.4\r\n */\r\n\r\nimport { ref, watch, onMounted, onUnmounted } from 'vue';\r\nimport type { PluginConstructor, ExportOptions } from '@ldesign/image-editor';\r\nimport { useImageEditor } from '../../composables/useImageEditor';\r\nimport { useEditorEvents } from '../../composables/useEditorEvents';\r\n\r\n/**\r\n * Additional editor options type (excluding props that are passed separately)\r\n */\r\ninterface AdditionalEditorOptions {\r\n  backgroundColor?: string;\r\n  historyLimit?: number;\r\n  responsive?: boolean;\r\n  deviceType?: 'auto' | 'pc' | 'mobile';\r\n  toolbar?: {\r\n    theme?: 'light' | 'dark' | 'auto';\r\n    zoom?: boolean;\r\n    tools?: boolean;\r\n    history?: boolean;\r\n    export?: boolean;\r\n    primaryColor?: string;\r\n    disabledTools?: string[];\r\n    autoHide?: boolean;\r\n    placeholderText?: string;\r\n    placeholderSubText?: string;\r\n  } | false;\r\n}\r\n\r\n/**\r\n * Component props\r\n * Requirements: 9.2\r\n */\r\nconst props = withDefaults(defineProps<{\r\n  /** Image source URL */\r\n  image?: string;\r\n  /** Canvas width */\r\n  width?: number;\r\n  /** Canvas height */\r\n  height?: number;\r\n  /** Plugins to enable */\r\n  plugins?: PluginConstructor[];\r\n  /** Additional editor options */\r\n  options?: AdditionalEditorOptions;\r\n}>(), {\r\n  image: undefined,\r\n  width: undefined,\r\n  height: undefined,\r\n  plugins: () => [],\r\n  options: () => ({}),\r\n});\r\n\r\n/**\r\n * Component emits\r\n * Requirements: 9.3\r\n */\r\nconst emit = defineEmits<{\r\n  /** Editor is ready */\r\n  (e: 'ready', payload: { width: number; height: number }): void;\r\n  /** Error occurred */\r\n  (e: 'error', payload: { error: Error }): void;\r\n  /** Tool changed */\r\n  (e: 'tool-change', payload: { tool: string; prevTool: string | null }): void;\r\n  /** History changed */\r\n  (e: 'history-change', payload: { canUndo: boolean; canRedo: boolean }): void;\r\n  /** Image loaded */\r\n  (e: 'image-loaded', payload: { width: number; height: number }): void;\r\n  /** Before export */\r\n  (e: 'before-export', payload: { options: ExportOptions }): void;\r\n  /** After export */\r\n  (e: 'after-export', payload: { data: string | Blob | File }): void;\r\n  /** Editor destroyed */\r\n  (e: 'destroy'): void;\r\n}>();\r\n\r\n// Container element ref\r\nconst containerRef = ref<HTMLDivElement>();\r\n\r\n// Initialize useImageEditor composable\r\nconst {\r\n  editor,\r\n  isReady,\r\n  isLoading,\r\n  error,\r\n  currentTool,\r\n  canUndo,\r\n  canRedo,\r\n  width: editorWidth,\r\n  height: editorHeight,\r\n  init,\r\n  loadImage,\r\n  exportImage,\r\n  undo,\r\n  redo,\r\n  setTool,\r\n  destroy,\r\n} = useImageEditor({\r\n  image: props.image,\r\n  width: props.width,\r\n  height: props.height,\r\n  plugins: props.plugins,\r\n  options: props.options,\r\n});\r\n\r\n// Setup event forwarding\r\nconst {\r\n  onReady,\r\n  onError,\r\n  onImageLoaded,\r\n  onToolChange,\r\n  onHistoryChange,\r\n  onBeforeExport,\r\n  onAfterExport,\r\n  onDestroy,\r\n} = useEditorEvents(editor);\r\n\r\n// Forward events to parent component\r\nonReady((data) => emit('ready', data));\r\nonError((data) => emit('error', data));\r\nonImageLoaded((data) => emit('image-loaded', data));\r\nonToolChange((data) => emit('tool-change', data));\r\nonHistoryChange((data) => emit('history-change', data));\r\nonBeforeExport((data) => emit('before-export', data));\r\nonAfterExport((data) => emit('after-export', data));\r\nonDestroy(() => emit('destroy'));\r\n\r\n// Initialize editor on mount\r\nonMounted(() => {\r\n  if (containerRef.value) {\r\n    init(containerRef.value);\r\n  }\r\n});\r\n\r\n// Watch for image prop changes\r\nwatch(\r\n  () => props.image,\r\n  async (newImage) => {\r\n    if (newImage && editor.value) {\r\n      try {\r\n        await loadImage(newImage);\r\n      } catch (err) {\r\n        // Error is already emitted via event\r\n      }\r\n    }\r\n  }\r\n);\r\n\r\n// Cleanup on unmount\r\nonUnmounted(() => {\r\n  destroy();\r\n});\r\n\r\n/**\r\n * Exposed methods for parent component access via ref\r\n * Requirements: 9.4\r\n */\r\ndefineExpose({\r\n  /** Editor instance */\r\n  editor,\r\n  /** Whether editor is ready */\r\n  isReady,\r\n  /** Whether editor is loading */\r\n  isLoading,\r\n  /** Current error */\r\n  error,\r\n  /** Current tool name */\r\n  currentTool,\r\n  /** Whether can undo */\r\n  canUndo,\r\n  /** Whether can redo */\r\n  canRedo,\r\n  /** Canvas width */\r\n  width: editorWidth,\r\n  /** Canvas height */\r\n  height: editorHeight,\r\n  /** Load image */\r\n  loadImage,\r\n  /** Export image */\r\n  export: exportImage,\r\n  /** Undo operation */\r\n  undo,\r\n  /** Redo operation */\r\n  redo,\r\n  /** Set current tool */\r\n  setTool,\r\n});\r\n</script>\r\n\r\n<template>\r\n  <div ref=\"containerRef\" class=\"image-editor-container\">\r\n    <slot name=\"loading\" v-if=\"isLoading\">\r\n      <div class=\"image-editor-loading\">Loading...</div>\r\n    </slot>\r\n    <slot name=\"error\" v-if=\"error\" :error=\"error\">\r\n      <div class=\"image-editor-error\">{{ error.message }}</div>\r\n    </slot>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.image-editor-container {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n}\r\n\r\n.image-editor-loading,\r\n.image-editor-error {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  padding: 16px;\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n}\r\n\r\n.image-editor-loading {\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  color: white;\r\n}\r\n\r\n.image-editor-error {\r\n  background-color: rgba(255, 0, 0, 0.1);\r\n  color: #d32f2f;\r\n  border: 1px solid #d32f2f;\r\n}\r\n</style>\r\n","/**\r\n * @ldesign/image-editor-vue\r\n * Vue wrapper components and composables for image editor\r\n * \r\n * @packageDocumentation\r\n * @module @ldesign/image-editor-vue\r\n * \r\n * @example\r\n * Using the ImageEditor component:\r\n * ```typescript\r\n * import { ImageEditor } from '@ldesign/image-editor-vue';\r\n * import { MosaicPlugin, TextPlugin } from '@ldesign/image-editor';\r\n * ```\r\n * \r\n * @example\r\n * Using the composables:\r\n * ```typescript\r\n * import { useImageEditor, useEditorEvents } from '@ldesign/image-editor-vue';\r\n * ```\r\n */\r\n\r\n// ============================================================================\r\n// Components\r\n// ============================================================================\r\nexport { ImageEditor } from './components';\r\n\r\n// ============================================================================\r\n// Composables\r\n// ============================================================================\r\nexport { useImageEditor, useEditorEvents } from './composables';\r\nexport type { UseEditorEventsReturn } from './composables';\r\n\r\n// ============================================================================\r\n// Types\r\n// ============================================================================\r\nexport type {\r\n  ImageEditorProps,\r\n  ImageEditorEmits,\r\n  ImageEditorExpose,\r\n  UseImageEditorOptions,\r\n  UseImageEditorReturn,\r\n} from './types';\r\n\r\n// ============================================================================\r\n// Re-export core types for convenience\r\n// ============================================================================\r\nexport type {\r\n  EditorOptions,\r\n  ExportOptions,\r\n  PluginConstructor,\r\n  Plugin,\r\n  EditorEvents,\r\n  MosaicConfig,\r\n  TextConfig,\r\n  FilterConfig,\r\n} from '@ldesign/image-editor';\r\n\r\n// ============================================================================\r\n// Version information\r\n// ============================================================================\r\nexport const VERSION = '0.2.0';\r\n"],"names":["useImageEditor","options","editor","shallowRef","isReady","ref","isLoading","error","currentTool","canUndo","canRedo","width","height","init","container","destroy","editorOptions","editorInstance","Editor","setupEventListeners","err","data","loadImage","source","exportImage","exportOptions","undo","redo","setTool","tool","onUnmounted","useEditorEvents","editorRef","registeredHandlers","createEventRegistration","event","handler","on","stopWatch","watch","newEditor","oldEditor","index","h","off","removeAllListeners","props","__props","emit","__emit","containerRef","editorWidth","editorHeight","onReady","onError","onImageLoaded","onToolChange","onHistoryChange","onBeforeExport","onAfterExport","onDestroy","onMounted","newImage","__expose","_createElementBlock","_unref","_renderSlot","_ctx","_cache","_createElementVNode","_hoisted_1","_toDisplayString","VERSION"],"mappings":"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"}